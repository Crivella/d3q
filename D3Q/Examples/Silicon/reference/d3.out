
     Program D3_toten v.5.4.0 starts on 20Jul2016 at 17: 9: 5 

     This program is part of the open-source Quantum ESPRESSO suite
     for quantum simulation of materials; please cite
         "P. Giannozzi et al., J. Phys.:Condens. Matter 21 395502 (2009);
          URL http://www.quantum-espresso.org", 
     in publications or presentations arising from this work. More details at
     http://www.quantum-espresso.org/quote

     Parallel version (MPI), running on     1 processors
      ___  ____   __    ____  ____  ____  _  _  ___    ____  ___ 
     / __)(_  _) /__\  (  _ \(_  _)(_  _)( \( )/ __)  (  _ \(__ )
     \__ \  )(  /(__)\  )   /  )(   _)(_  )  (( (_-.   )(_) )(_ \
     (___/ (__)(__)(__)(_)\_) (__) (____)(_)\_)\___/  (____/(___/

     Waiting for input...
     _____________ input start _____________
&INPUTD3Q
 ETHR_PH=  1.0000000000000001E-009,
 AMASS= 10*0.0000000000000000       ,
 PREFIX="silicon                                                                                                                                                                                                                                                         ",
 OUTDIR="./tmp                                                                                                                                                                                                                                                           ",
 FILDRHO_DIR="FILDRHO                                                                                                                                                                                                                                                         ",
 D3DIR="                                                                                                                                                                                                                                                                ",
 FILD3DYN="FILD3DYN/anh                                                    ",
 FILDRHO="auto:drho                                                                                                                                                                                                                                                       ",
 FILD1RHO="                                                                                                                                                                                                                                                                ",
 FILD2RHO="                                                                                                                                                                                                                                                                ",
 FILD3RHO="                                                                                                                                                                                                                                                                ",
 ISTOP=          0,
 MODE="full                                                                                                                                                                                                                                                            ",
 IVERBOSITY=          0,
 FIRST=          1,
 LAST=          4,
 STEP=          1,
 OFFSET=          0,
 SAFE_IO=F,
 RESTART=F,
 MAX_TIME= -1.0000000000000000     ,
 MAX_SECONDS=         -1,
 PRINT_STAR=T,
 PRINT_PERM=F,
 PRINT_TREV=T,
 D3_NK1=         -1,
 D3_NK2=         -1,
 D3_NK3=         -1,
 D3_K1=         -1,
 D3_K2=         -1,
 D3_K3=         -1,
 D3_DEGAUSS= -1.0000000000000000     ,
 /
     _____________  input end  _____________
     Doing grid dispersion calculation
     Checking for debug instructions.

     Reading data from directory:
     ./tmp/silicon.save

   Info: using nr1, nr2, nr3 values from input

   Info: using nr1, nr2, nr3 values from input

     IMPORTANT: XC functional enforced from input :
     Exchange-correlation      =  SLA  PZ   NOGX NOGC ( 1  1  0  0 0 0)
     Any further DFT definition will be discarded
     Please, verify this is what you really want


     G-vector sticks info
     --------------------
     sticks:   dense  smooth     PW     G-vecs:    dense   smooth      PW
     Sum         349     349    109                 4279     4279     749

     Message from routine kpoint_grid:
     ATTENTION: skip check of k-points equivalence
     Looking for irreducible triplets out of      108 possibilities:
           1:   (  0.0000  0.0000  0.0000 )   (  0.0000  0.0000  0.0000 )   ( -0.0000 -0.0000 -0.0000 )
           2:   (  0.0000  0.0000  0.0000 )   ( -0.3333  0.3333 -0.3333 )   (  0.3333 -0.3333  0.3333 )
           3:   (  0.0000  0.0000  0.0000 )   (  0.0000  0.6667  0.0000 )   ( -0.0000 -0.6667 -0.0000 )
           4:   (  0.0000  0.0000  0.0000 )   (  0.6667 -0.0000  0.6667 )   ( -0.6667  0.0000 -0.6667 )
           5:   ( -0.3333  0.3333 -0.3333 )   ( -0.3333  0.3333 -0.3333 )   (  0.6667 -0.6667  0.6667 )
           6:   ( -0.3333  0.3333 -0.3333 )   (  0.3333  0.3333  0.3333 )   (  0.0000 -0.6667  0.0000 )
           7:   ( -0.3333  0.3333 -0.3333 )   (  0.0000  0.6667  0.0000 )   (  0.3333 -1.0000  0.3333 )
           8:   ( -0.3333  0.3333 -0.3333 )   (  0.6667 -0.0000  0.6667 )   ( -0.3333 -0.3333 -0.3333 )
           9:   ( -0.3333  0.3333 -0.3333 )   ( -0.6667 -0.6667 -0.0000 )   (  1.0000  0.3333  0.3333 )
          10:   (  0.0000  0.6667  0.0000 )   (  0.0000  0.6667  0.0000 )   ( -0.0000 -1.3333 -0.0000 )
          11:   (  0.0000  0.6667  0.0000 )   ( -0.6667  0.0000  0.0000 )   (  0.6667 -0.6667 -0.0000 )
          12:   (  0.0000  0.6667  0.0000 )   (  0.3333 -0.3333  1.0000 )   ( -0.3333 -0.3333 -1.0000 )
          13:   (  0.6667 -0.0000  0.6667 )   (  0.6667 -0.0000  0.6667 )   ( -1.3333  0.0000 -1.3333 )
          14:   (  0.6667 -0.0000  0.6667 )   (  0.3333 -0.3333  1.0000 )   ( -1.0000  0.3333 -1.6667 )
     IRREDUCIBLE NUMBER OF TRIPLETS TO COMPUTE:  14
     Triplets to be computed in this run (     4 total):
          1   2   3   4

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    1 (    1 of    4,   0% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (    0.000000   0.000000   0.000000 )   =
     =    q3 = (   -0.000000  -0.000000  -0.000000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_0_0'
         --> drho file for q3 found as 'drho.0_0_0'
     ================== setup started ==================
     Special cases for qs:
       q1 = G  , q2 , -q2, q3 , -q3
       q2 = G  , q1 , -q1, q3 , -q3
       q3 = G  , q1 , -q1, q2 , -q2
       Symmetry operations:
         q1:  0  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2:  0  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q3:  0  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
       Symmetry common to all q vectors:
             TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         -->48 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:     8
       --> after including k+/-q_i (kunit):     8 (1)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0.out

     Writing output data file silicon.save

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> not opening: drho.0_0_0
         q3 --> not opening: drho.0_0_0

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_0_Q3.0_0_0/

     ================= d3_init start
     alpha_pv:      1.7739

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) 
       Permutation 3 (213) can be obtained from 1 (123) 
       Permutation 4 (231) can be obtained from 1 (123) 
       Permutation 5 (312) can be obtained from 1 (123) 
       Permutation 6 (321) can be obtained from 1 (123) 
     1 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :     0.58s CPU         0.60s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     0.60 sec    Total time:        0.60 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      0.6/      1.2 secs     av.it.  17.2
         pert=    2     time taken/total=      0.6/      1.8 secs     av.it.  17.4

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping <psi_k+q2 |d^q2V| psi_k>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k |d^q2V| psi_k-q2>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping P_c^-q2 |d^-q2 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q2 psi_k+q2>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping <psi_k-q3 |d^q1V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q2 |d^q1V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q1V| psi_k+q1>


     generate_dwfc   cpu time:     1.20 sec    Total time:        1.80 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:        1.80 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
     dpsi1dv2dpsi3 cpu time:     0.48 sec    Total time:        2.28 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
     dpsi1dpsi2dv3 cpu time:     0.03 sec    Total time:        2.30 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
     drhod2v       cpu time:     0.11 sec    Total time:        2.42 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.09 sec    Total time:        2.51 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.52 sec    Total time:        3.02 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.02 sec    Total time:        3.04 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * imposing hermiticity on idx 1,3
       * imposing hermiticity on idx 1,2
       * symmetrizing with 48 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
     d3matrix      cpu time:     0.00 sec    Total time:        3.04 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :      2.99s CPU      3.04s WALL (       1 calls)
     --> wfc and dwfc
     nscf         :      0.26s CPU      0.26s WALL (       1 calls)
     generate_dwf :      1.18s CPU      1.20s WALL (       1 calls)
     --> matrix elements
     dpsi1dv2dpsi :      0.47s CPU      0.48s WALL (       1 calls)
     dpsi1dpsi2dv :      0.02s CPU      0.03s WALL (       1 calls)
     dq1rhodq23v  :      0.11s CPU      0.11s WALL (       1 calls)
     rhodq123v    :      0.09s CPU      0.09s WALL (       1 calls)
     d3ionq       :      0.52s CPU      0.52s WALL (       1 calls)
     d3_exc       :      0.01s CPU      0.02s WALL (       1 calls)
     d3matrix     :      0.00s CPU      0.00s WALL (       1 calls)
     --> total I/O
     davcio       :      0.02s CPU      0.01s WALL (    2852 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    2 (    2 of    4,  25% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (   -0.333333   0.333333  -0.333333 )   =
     =    q3 = (    0.333333  -0.333333   0.333333 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_0_1o3'
         --> drho file for q3 found as 'drho.0_0_-1o3'
     ================== setup started ==================
     Special cases for qs:
       q1 = G
       q2 = -q3
       q3 = -q2
       Symmetry operations:
         q1: 48  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2: 48  TFFFFFFFFFFFFFFFFFFTFTFFFFFFTFFFFTFFTFFFFFFFFFFF
         q3: 48  TFFFFFFFFFFFFFFFFFFTFTFFFFFFTFFFFTFFTFFFFFFFFFFF
       Symmetry common to all q vectors:
             TFFFFFFFFFFFFFFFFFFTFTFFFFFFTFFFFTFFTFFFFFFFFFFF
         --> 6 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
         --> taking c.c. of patterns for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    20
       --> after including k+/-q_i (kunit):    60 (3)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3.out

     Writing output data file silicon.save

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> opening: drho.0_0_1o3
         q3 --> not opening: drho.0_0_-1o3

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u: 302   recl:     27648   ext:                   drho.0_0_1o3   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_0_1o3_Q3.0_0_-1o3/

     ================= d3_init start
     alpha_pv:      1.7739

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) with c.c.
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) can be obtained from 3 (213) with c.c.
       Permutation 6 (321) can be obtained from 4 (231) with c.c.
     3 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :     4.60s CPU         4.67s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     1.62 sec    Total time:        4.67 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      1.5/      6.2 secs     av.it.  17.9
         pert=    2     time taken/total=      1.5/      7.7 secs     av.it.  18.0

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.5/      8.3 secs     av.it.  18.8
         pert=    2     time taken/total=      0.5/      8.8 secs     av.it.  18.8
         pert=    3     time taken/total=      1.1/      9.9 secs     av.it.  19.1
         pert=    4     time taken/total=      1.1/     10.9 secs     av.it.  19.1

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.5/     11.4 secs     av.it.  17.8
         pert=    2     time taken/total=      0.5/     11.9 secs     av.it.  17.8
         pert=    3     time taken/total=      1.1/     13.0 secs     av.it.  18.6
         pert=    4     time taken/total=      1.1/     14.1 secs     av.it.  18.4

     Computing <psi_k-q2 |d^-q2V| psi_k>

     Computing <psi_k |d^-q2V| psi_k+q2>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q2 |d^q2 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q2 psi_k+q3>

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q2 |d^q2V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q2V| psi_k+q3>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:    10.24 sec    Total time:       14.91 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:       14.91 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
     dpsi1dv2dpsi3 cpu time:     3.33 sec    Total time:       18.24 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.19 sec    Total time:       18.43 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
     drhod2v       cpu time:     0.53 sec    Total time:       18.95 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.17 sec    Total time:       19.12 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.23 sec    Total time:       19.35 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.02 sec    Total time:       19.37 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * symmetrizing with  6 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
       point #  4  : star #  4  perm #  1 ( 1 2 3 )
       point #  5  : star #  5  perm #  1 ( 1 2 3 )
       point #  6  : star #  6  perm #  1 ( 1 2 3 )
       point #  7  : star #  7  perm #  1 ( 1 2 3 )
       point #  8  : star #  8  perm #  1 ( 1 2 3 )
     d3matrix      cpu time:     0.03 sec    Total time:       19.39 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :     19.09s CPU     19.40s WALL (       2 calls)
     --> wfc and dwfc
     nscf         :      1.78s CPU      1.80s WALL (       2 calls)
     generate_dwf :     11.25s CPU     11.45s WALL (       2 calls)
     --> matrix elements
     dpsi1dv2dpsi :      3.76s CPU      3.80s WALL (       4 calls)
     dpsi1dpsi2dv :      0.20s CPU      0.22s WALL (       4 calls)
     dq1rhodq23v  :      0.62s CPU      0.64s WALL (       3 calls)
     rhodq123v    :      0.26s CPU      0.26s WALL (       2 calls)
     d3ionq       :      0.74s CPU      0.74s WALL (       2 calls)
     d3_exc       :      0.03s CPU      0.04s WALL (       2 calls)
     d3matrix     :      0.03s CPU      0.03s WALL (       2 calls)
     --> total I/O
     davcio       :      0.10s CPU      0.08s WALL (   23582 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    3 (    3 of    4,  50% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (    0.000000   0.666667   0.000000 )   =
     =    q3 = (   -0.000000  -0.666667  -0.000000 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_1o3_1o3'
         --> drho file for q3 found as 'drho.0_-1o3_-1o3'
     ================== setup started ==================
     Special cases for qs:
       q1 = G
       q2 = -q3
       q3 = -q2
       Symmetry operations:
         q1: 48  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2:  6  TFFFTFFFFFTTFFFFFFFFFTFFFTFTFFFFTFFFFFFFFFFFFFFF
         q3:  6  TFFFTFFFFFTTFFFFFFFFFTFFFTFTFFFFTFFFFFFFFFFFFFFF
       Symmetry common to all q vectors:
             TFFFTFFFFFTTFFFFFFFFFTFFFTFTFFFFTFFFFFFFFFFFFFFF
         --> 8 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
         --> taking c.c. of patterns for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    18
       --> after including k+/-q_i (kunit):    54 (3)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3.out

     Writing output data file silicon.save

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> opening: drho.0_1o3_1o3
         q3 --> not opening: drho.0_-1o3_-1o3

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u: 302   recl:     27648   ext:                 drho.0_1o3_1o3   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_1o3_Q3.0_-1o3_-1o3/

     ================= d3_init start
     alpha_pv:      1.7739

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) with c.c.
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) can be obtained from 3 (213) with c.c.
       Permutation 6 (321) can be obtained from 4 (231) with c.c.
     3 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :    20.52s CPU        20.84s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     1.45 sec    Total time:       20.84 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      1.4/     22.2 secs     av.it.  17.6
         pert=    2     time taken/total=      1.4/     23.6 secs     av.it.  17.7

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.5/     24.0 secs     av.it.  17.9
         pert=    2     time taken/total=      0.5/     24.5 secs     av.it.  17.9
         pert=    3     time taken/total=      1.0/     25.5 secs     av.it.  19.0
         pert=    4     time taken/total=      1.0/     26.4 secs     av.it.  18.6

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.4/     26.9 secs     av.it.  16.9
         pert=    2     time taken/total=      0.4/     27.3 secs     av.it.  16.9
         pert=    3     time taken/total=      0.9/     28.3 secs     av.it.  18.2
         pert=    4     time taken/total=      0.9/     29.2 secs     av.it.  17.9

     Computing <psi_k-q2 |d^-q2V| psi_k>

     Computing <psi_k |d^-q2V| psi_k+q2>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q2 |d^q2 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q2 psi_k+q3>

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q2 |d^q2V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q2V| psi_k+q3>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:     9.17 sec    Total time:       30.02 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:       30.02 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
     dpsi1dv2dpsi3 cpu time:     3.35 sec    Total time:       33.37 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.18 sec    Total time:       33.55 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
     drhod2v       cpu time:     0.49 sec    Total time:       34.04 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.16 sec    Total time:       34.20 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.23 sec    Total time:       34.43 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.02 sec    Total time:       34.45 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * symmetrizing with  8 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
       point #  4  : star #  4  perm #  1 ( 1 2 3 )
       point #  5  : star #  5  perm #  1 ( 1 2 3 )
       point #  6  : star #  6  perm #  1 ( 1 2 3 )
     d3matrix      cpu time:     0.02 sec    Total time:       34.47 sec

     =============== computing D3 done

     ================== cleanup start

     D3TOTEN      :     33.99s CPU     34.47s WALL (       3 calls)
     --> wfc and dwfc
     nscf         :      3.12s CPU      3.15s WALL (       3 calls)
     generate_dwf :     20.31s CPU     20.62s WALL (       3 calls)
     --> matrix elements
     dpsi1dv2dpsi :      7.07s CPU      7.16s WALL (       7 calls)
     dpsi1dpsi2dv :      0.37s CPU      0.40s WALL (       7 calls)
     dq1rhodq23v  :      1.11s CPU      1.13s WALL (       5 calls)
     rhodq123v    :      0.42s CPU      0.41s WALL (       3 calls)
     d3ionq       :      0.97s CPU      0.97s WALL (       3 calls)
     d3_exc       :      0.05s CPU      0.06s WALL (       3 calls)
     d3matrix     :      0.05s CPU      0.05s WALL (       3 calls)
     --> total I/O
     davcio       :      0.16s CPU      0.15s WALL (   42272 calls)

     ================== cleanup done

     ===================================================
     =             Starting D3 calculation             =
     ===================================================
     =     triplet    4 (    4 of    4,  75% done)     =
     ===================================================
     =    q1 = (    0.000000   0.000000   0.000000 )   =
     =    q2 = (    0.666667  -0.000000   0.666667 )   =
     =    q3 = (   -0.666667   0.000000  -0.666667 )   =
     ===================================================
     Temporary directory set to:
       ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     Scanning for fildrho files...
         --> drho file for q1 found as 'drho.0_0_0'
         --> drho file for q2 found as 'drho.0_1o3_-1o3'
         --> drho file for q3 found as 'drho.0_-1o3_1o3'
     ================== setup started ==================
     Special cases for qs:
       q1 = G
       q2 = -q3
       q3 = -q2
       Symmetry operations:
         q1: 48  TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
         q2:  8  TTFFFFFFTFFFFFFFFFFFFFFFFFTFFFFFFFFFFFFFFFFFFFFF
         q3:  8  TTFFFFFFTFFFFFFFFFFFFFFFFFTFFFFFFFFFFFFFFFFFFFFF
       Symmetry common to all q vectors:
             TTFFFFFFTFFFFFFFFFFFFFFFFFTFFFFFFFFFFFFFFFFFFFFF
         --> 4 symmetry operation(s) have been found
 REMARK: q -> -q symmetry yet unsupported in d3q.x
         individual q --> -q operations: FFF
       Reading patterns and q-point for q1
       Reading patterns and q-point for q2
       Reading patterns and q-point for q3
         --> taking c.c. of patterns for q3
       Symmetry information for Gamma associated with q1

     Symmetry analysis done
     =================== setup done ====================



     =============== run_nscf_d3 start

     Starting non-scf calculation of ground state wavefunctions.

     WARNING: check_stop already initialized
       * has time reversal symmetry.
     Total number of kpoints:
       --> after reducing symmetry:    26
       --> after including k+/-q_i (kunit):    78 (3)

     --> output from 'electrons' appended to ./tmp//nscf_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3.out

     Writing output data file silicon.save

     =============== run_nscf_d3 done

     =============== allocate_d3 start

     =============== allocate_d3 done

     ============== openfile_drho start

     Opening files of charge density derivative.
         q1 --> opening: drho.0_0_0
         q2 --> opening: drho.0_1o3_-1o3
         q3 --> not opening: drho.0_-1o3_1o3

     ============== openfile_drho done

     ================ openfild3 start

     ================ openfild3 done
     u: 301   recl:     27648   ext:                     drho.0_0_0   tmp: FILDRHO/
     u: 302   recl:     27648   ext:                drho.0_1o3_-1o3   tmp: FILDRHO/
     u:  20   recl:      4352   ext:                            wfc   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5022   recl:      4352   ext:                        dq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6022   recl:        32   ext:                      pdvq2pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5023   recl:      4352   ext:                        dq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6023   recl:        32   ext:                      pdvq2pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5021   recl:      4352   ext:                        dq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6021   recl:        32   ext:                      pdvq2pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5032   recl:      4352   ext:                        dq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6032   recl:        32   ext:                      pdvq3pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5033   recl:      4352   ext:                        dq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6033   recl:        32   ext:                      pdvq3pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5031   recl:      4352   ext:                        dq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6031   recl:        32   ext:                      pdvq3pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5012   recl:      4352   ext:                        dq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6012   recl:        32   ext:                      pdvq1pq2.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5013   recl:      4352   ext:                        dq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6013   recl:        32   ext:                      pdvq1pq3.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:5011   recl:      4352   ext:                        dq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/
     u:6011   recl:        32   ext:                      pdvq1pq1.   tmp: ./tmp//D3_Q1.0_0_0_Q2.0_1o3_-1o3_Q3.0_-1o3_1o3/

     ================= d3_init start
     alpha_pv:      1.7739

     ================= d3_init done

     ========== d3_check_permutations start
     Looking for equivalent permutations of q vectors
       Permutation 1 (123) has to be computed explicitly
       Permutation 2 (132) can be obtained from 1 (123) with c.c.
       Permutation 3 (213) has to be computed explicitly
       Permutation 4 (231) has to be computed explicitly
       Permutation 5 (312) can be obtained from 3 (213) with c.c.
       Permutation 6 (321) can be obtained from 4 (231) with c.c.
     3 inequivalent permutations were found

     ========== d3_check_permutations done
     D3_toten     :    36.07s CPU        36.59s WALL


     ================== add core start

     Adding derivative of core charge
     d3_add_rho_core   cpu time:     2.12 sec    Total time:       36.59 sec

     ================== add core done

     ===================================================
     = Nscf calculation of the perturbed wavefunctions =
     ===================================================

     Computing P_c^q1 |d^q1 psi_k>
         pert=    1     time taken/total=      2.1/     38.6 secs     av.it.  17.6
         pert=    2     time taken/total=      2.2/     40.8 secs     av.it.  17.8

     Skipping P_c^G |d^q1 psi_k-q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^-q1 |d^-q1 psi_k>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Skipping P_c^G |d^-q1 psi_k+q1>
       --> already done as P_c^q1 |d^q1 psi_k+q1>

     Computing P_c^q2 |d^q2 psi_k>
         pert=    1     time taken/total=      0.7/     41.6 secs     av.it.  18.8
         pert=    2     time taken/total=      0.7/     42.3 secs     av.it.  18.9
         pert=    3     time taken/total=      0.7/     43.0 secs     av.it.  18.0
         pert=    4     time taken/total=      0.7/     43.7 secs     av.it.  17.9
         pert=    5     time taken/total=      0.7/     44.4 secs     av.it.  18.7
         pert=    6     time taken/total=      0.7/     45.2 secs     av.it.  18.8

     Computing P_c^G |d^q2 psi_k-q2>
         pert=    1     time taken/total=      0.7/     45.9 secs     av.it.  17.6
         pert=    2     time taken/total=      0.7/     46.6 secs     av.it.  17.7
         pert=    3     time taken/total=      0.7/     47.2 secs     av.it.  17.1
         pert=    4     time taken/total=      0.7/     47.9 secs     av.it.  16.8
         pert=    5     time taken/total=      0.7/     48.6 secs     av.it.  17.5
         pert=    6     time taken/total=      0.7/     49.3 secs     av.it.  17.5

     Computing <psi_k-q2 |d^-q2V| psi_k>

     Computing <psi_k |d^-q2V| psi_k+q2>

     Skipping <psi_k+q3 |d^q3V| psi_k>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k |d^q3V| psi_k-q3>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>

     Skipping P_c^-q3 |d^-q3 psi_k>
       --> already done as P_c^q2 |d^q2 psi_k+q1>

     Skipping P_c^G |d^-q3 psi_k+q3>
       --> already done as P_c^q1 |d^q2 psi_k+q3>

     Computing <psi_k-q3 |d^q1V| psi_k+q2>

     Computing <psi_k-q2 |d^q1V| psi_k+q3>

     Skipping <psi_k-q3 |d^q2V| psi_k+q1>
       --> already done as <psi_k+q2 |d^q2V| psi_k+q1>

     Skipping <psi_k-q1 |d^q2V| psi_k+q3>
       --> already done as <psi_k+q1 |d^q2V| psi_k+q3>

     Skipping <psi_k-q2 |d^q3V| psi_k+q1>
       --> already done as <psi_k+q3 |d^q3V| psi_k+q1>

     Skipping <psi_k-q1 |d^q3V| psi_k+q2>
       --> already done as <psi_k+q1 |d^q3V| psi_k+q2>


     generate_dwfc   cpu time:    13.87 sec    Total time:       50.46 sec

     ================== nscf dpsi done =================


     ================== precomp start

     Pre-computing < Pc dpsi_(k+X)/du(-X)| dH/du(Y) | psi_k-Y >
     gen_dpsi1dv2psi     cpu time:     0.00 sec    Total time:       50.46 sec

     ================== precomp done

     ================== dpdvdp start

     Calculating the matrix elements <dpsi |dH |dpsi>
       <d^-q3 psi_k|d^q2  V|d^q1  psi_k>
       <d^-q3 psi_k|d^q1  V|d^q2  psi_k>
       <d^-q1 psi_k|d^q3  V|d^q2  psi_k>
     dpsi1dv2dpsi3 cpu time:     4.89 sec    Total time:       55.35 sec

     ================== dpdvdp done

     ================== dpdpdv start

     Calculating the matrix elements <dpsi|dpsi>< psi|dH|psi> 
       <d_-q3 psi_k+q3| d_q1 psi_k-q1> <psi_k-q1|d_q2 H|psi_k+q3>
       <d_-q3 psi_k+q3| d_q2 psi_k-q2> <psi_k-q2|d_q1 H|psi_k+q3>
       <d_-q1 psi_k+q1| d_q2 psi_k-q2> <psi_k-q2|d_q3 H|psi_k+q1>
     dpsi1dpsi2dv3 cpu time:     0.26 sec    Total time:       55.60 sec

     ================== dpdpdv done

     ================== dpd2v start

     Calculating the matrix elements <psi |d^2 v |dpsi>
       <d_q1 psi_k| d^2_(q2,q3) V|psi_k>
       <d_q2 psi_k| d^2_(q1,q3) V|psi_k>
     drhod2v       cpu time:     0.70 sec    Total time:       56.31 sec

     ================== dpd2v done

     =================== rho d3v start =================


     Calculating the matrix elements <psi |d^3v |psi>
     d3vrho        cpu time:     0.21 sec    Total time:       56.52 sec

     =================== rho d3v done ==================


     ================== ewald start

     Calculating the Ewald contribution

     Alpha used in Ewald sum =   1.01
     d3ionq        cpu time:     0.23 sec    Total time:       56.75 sec

     ================== ewald done

     ================ exc contrib start

     Calculating the exchange-correlation contribution
     d3_exc        cpu time:     0.02 sec    Total time:       56.77 sec

     ================ exc contrib done

     =============== computing D3 start

     Symmetrizing and writing the tensor to disc

     CALLing d3matrix
       * imposing hermiticity on idx 2,3
       * symmetrizing with  4 sym.ops.
       point #  1  : star #  1  perm #  1 ( 1 2 3 )
       point #  2  : star #  2  perm #  1 ( 1 2 3 )
       point #  3  : star #  3  perm #  1 ( 1 2 3 )
       point #  4  : star #  4  perm #  1 ( 1 2 3 )
       point #  5  : star #  5  perm #  1 ( 1 2 3 )
       point #  6  : star #  6  perm #  1 ( 1 2 3 )
       point #  7  : star #  7  perm #  1 ( 1 2 3 )
       point #  8  : star #  8  perm #  1 ( 1 2 3 )
       point #  9  : star #  9  perm #  1 ( 1 2 3 )
       point # 10  : star # 10  perm #  1 ( 1 2 3 )
       point # 11  : star # 11  perm #  1 ( 1 2 3 )
       point # 12  : star # 12  perm #  1 ( 1 2 3 )
     d3matrix      cpu time:     0.04 sec    Total time:       56.81 sec

     =============== computing D3 done

     ================== cleanup start

     ================== cleanup done

     D3TOTEN      :     56.03s CPU     56.82s WALL (       4 calls)

      NSCF calculation of ground-state wfcs
     init_run     :      0.15s CPU      0.15s WALL (       4 calls)
     electrons    :      4.62s CPU      4.68s WALL (       4 calls)
     c_bands      :      4.62s CPU      4.67s WALL (       4 calls)
     cegterg      :      4.03s CPU      4.10s WALL (     200 calls)

      NSCF calculation of perturbed wfcs
     generate_dwf :     33.98s CPU     34.49s WALL (       4 calls)
     solve_linter :     33.98s CPU     34.46s WALL (      76 calls)
     ortho        :      0.04s CPU      0.04s WALL (    1200 calls)
     cgsolve      :     28.93s CPU     29.42s WALL (    1200 calls)

     ch_psi       :     28.25s CPU     28.79s WALL (   23601 calls)
     h_psiq       :     26.90s CPU     27.33s WALL (   23601 calls)

     firstfft     :     11.68s CPU     11.99s WALL (   88249 calls)
     secondfft    :     12.34s CPU     12.43s WALL (   88249 calls)

      D3 setup and pre-calculations
     d3_setup     :      0.01s CPU      0.01s WALL (       4 calls)
     d3_setup_noq :      0.00s CPU      0.00s WALL (       1 calls)
     d3_init      :      0.38s CPU      0.39s WALL (       4 calls)

      D3 matrix elements
     dpsi1dv2dpsi :     11.92s CPU     12.04s WALL (      10 calls)
     dpsi1dpsi2dv :      0.62s CPU      0.65s WALL (      10 calls)
     dq1rhodq23v  :      1.81s CPU      1.84s WALL (       7 calls)
     rhodq123v    :      0.63s CPU      0.63s WALL (       4 calls)
     d3ionq       :      1.20s CPU      1.21s WALL (       4 calls)
     d3_exc       :      0.06s CPU      0.08s WALL (       4 calls)
     d3matrix     :      0.09s CPU      0.09s WALL (       4 calls)

      Input/output
     read_drho    :      0.04s CPU      0.06s WALL (    1266 calls)
     davcio       :      0.27s CPU      0.27s WALL (   69538 calls)

      General routines
     calbec       :      1.04s CPU      1.18s WALL (   50634 calls)

      Parallel routines
     fft_scatter  :      2.13s CPU      2.34s WALL (  282403 calls)
